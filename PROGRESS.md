# 小火箭 SDK 开发进度

> 更新日期：2026-02-09

## 📊 总体进度

```
Phase 1: 基础设施    ████████████████████ 100% ✅
Phase 2: 购买验证    ░░░░░░░░░░░░░░░░░░░░   0% ❌
Phase 3: 数据迁移    ████████████░░░░░░░░  60% 🟡
Phase 4: UI 交互     ████░░░░░░░░░░░░░░░░  20% 🟡
Phase 5: 多 App 适配 ░░░░░░░░░░░░░░░░░░░░   0% ❌
Phase 6: 灰度发布    ░░░░░░░░░░░░░░░░░░░░   0% ❌
```

---

## ✅ 已完成

### Phase 1: 基础设施 (Week 1) ✅

| 任务 | 状态 | 详情 |
|------|------|------|
| Supabase 项目 | ✅ | `ra-supabase-sb6xjntrfya75g` 运行中 |
| user_devices 表 | ✅ | public + test_public |
| user_purchases 表 | ✅ | public + test_public |
| profiles 表 | ✅ | 触发器自动创建 |
| RLS 策略 | ✅ | 全部配置完成 |
| 短信登录 | ✅ | 测试通过 (18520160445) |
| 环境隔离 | ✅ | test_public / public |

**交付物：**
- 数据库表结构 ✓
- 短信登录 API ✓
- Flutter SDK 基础 ✓

---

## 🟡 进行中

### Phase 3: 数据迁移 (Week 3) 🟡

| 任务 | 状态 | 详情 |
|------|------|------|
| CloudSyncService | 🟡 | 框架完成，OSS 上传待实现 |
| 设备→用户路径复制 | 🟡 | 逻辑完成，需测试 |
| 多设备数据合并 | ❌ | 框架待实现 |
| 迁移进度 UI | ❌ | 未开始 |
| 数据完整性测试 | ❌ | 未开始 |

**交付物：**
- `CloudSyncService` 类（框架）✓
- OSS 配置获取 ✓
- 路径切换逻辑 ✓

---

### Phase 4: UI 交互 (Week 4) 🟡

| 任务 | 状态 | 详情 |
|------|------|------|
| 登录页面 | ✅ | 完成 |
| 用户信息页面 | ✅ | 完成 |
| 同步测试页面 | 🟡 | 占位页面 |
| 迁移进度提示 | ❌ | 未开始 |
| 购买恢复引导 | ❌ | 未开始 |

**交付物：**
- `example_app` 示例 ✓

---

## ❌ 未开始

### Phase 2: 购买验证 (Week 2) ❌

| 任务 | 状态 | 优先级 | 说明 |
|------|------|--------|------|
| migrate-device-purchase Edge Function | ❌ | P1 | 设备购买迁移 |
| 苹果收据验证 | ❌ | P1 | App Store 验证 |
| 谷歌收据验证 | ❌ | P2 | Play Store 验证 |
| 购买凭证迁移测试 | ❌ | P1 | 端到端测试 |

**依赖：**
- 苹果 App Store Shared Secret
- 谷歌 Play Console API Key

---

### Phase 5: 多 App 适配 (Week 5) ❌

| 任务 | 状态 | 说明 |
|------|------|------|
| SDK 打包发布 | ❌ | pub.dev |
| 申论 App 集成 | ❌ | 测试 |
| 行测 App 集成 | ❌ | 测试 |
| 跨 App 数据隔离 | ❌ | 验证 |

---

### Phase 6: 灰度发布 (Week 6) ❌

| 任务 | 状态 | 说明 |
|------|------|------|
| 内部测试 | ❌ | 多设备场景 |
| 10% 灰度 | ❌ | 小范围测试 |
| 监控迁移成功率 | ❌ | 数据埋点 |
| 全量发布 | ❌ | 正式上线 |

---

### Phase 4: 登录体系升级 (Login Upgrade) 🟡

| 任务 | 状态 | 优先级 | 说明 |
|------|------|--------|------|
| **苹果登录** (Sign in with Apple) | ❌ | P0 | iOS App Store 必需，Supabase 原生支持 |
| **微信登录** (WeChat Login) | ❌ | P1 | 国内用户习惯，需实现 `auth-wechat` Edge Function |
| 登录 UI 适配 | ❌ | P2 | 增加第三方登录按钮 |
| 账号绑定逻辑 | ❌ | P2 | 手机号 + 微信 + 苹果 ID 关联 |

**交付物：**
- 完整的登录流程（手机号/苹果/微信）
- `auth-wechat` Edge Function

---

### Phase 5: UI 交互与完善 (Data Migration UI) ❌

| 任务 | 状态 | 详情 |
|------|------|------|
| 登录页面 | ✅ | 需增加第三方登录入口 |
| 用户信息页面 | ✅ | 需展示绑定状态 |
| 同步测试页面 | 🟡 | 占位页面 |
| 迁移进度提示 | ❌ | 未开始 |
| 购买恢复引导 | ❌ | 未开始 |

